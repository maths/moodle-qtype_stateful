define(["jquery","core/ajax","core/event"],function(a,b,c){"use strict";var d={typingDelay:1e3,timeoutHandles:{},activeFields:{},listeners:[]},e={register:function(e,f){f in d.activeFields||(d.activeFields[f]={});for(var g=0;g<e.length;g++)d.activeFields[f][e[g]]=!0;f in d.timeoutHandles||(d.timeoutHandles[f]=null);for(var h=a("#"+a.escapeSelector(f)+"__tech_details"),i=h.data("qaid"),j=h.data("seqn"),k=function(){var e={};Object.keys(d.activeFields[f]).forEach(function(b){var c=a("#"+a.escapeSelector(f+b));1===c.length?"checkbox"===c.first().prop("type")?c.first().prop("checked")&&(e[b]="true"):e[b]=c.val():(c=a("input[name="+a.escapeSelector(f+b)+"]:checked"),1===c.length&&(e[b]=c.first().val()))}),e=JSON.stringify(e),b.call([{methodname:"qtype_stateful_validate_input",args:{qaid:i,seqn:j,data:e},done:function(b){var e=JSON.parse(b.val_update),g=JSON.parse(b.vbox_update);Object.keys(e).forEach(function(b){var c=a("#"+a.escapeSelector(f+b));c.val(e[b]),c.trigger("change"),c.trigger("input")}),Object.keys(g).forEach(function(b){var d=a("#"+a.escapeSelector(f+"vbox_"+b));d.html(g[b]),""===g[b]?d.hide():d.show(),c.notifyFilterContentUpdated(d)});for(var h=0;h<d.listeners.length;h++)d.listeners[h]()}}])},g=0;g<e.length;g++){var l=a("#"+a.escapeSelector(f+e[g]));l.on("input",function(){for(var a=0;a<d.listeners.length;a++)d.listeners[a]();null!==d.timeoutHandles[f]&&(clearTimeout(d.timeoutHandles[f]),d.timeoutHandles[f]=null),d.timeoutHandles[f]=setTimeout(k,d.typingDelay)}),a('input[type=radio][name="'+a.escapeSelector(f+e[g])+'"]').on("click",function(){for(var a=0;a<d.listeners.length;a++)d.listeners[a]();null!==d.timeoutHandles[f]&&(clearTimeout(d.timeoutHandles[f]),d.timeoutHandles[f]=null),d.timeoutHandles[f]=setTimeout(k,d.typingDelay)}),a('select[name="'+a.escapeSelector(f+e[g])+'"]').on("change",function(){for(var a=0;a<d.listeners.length;a++)d.listeners[a]();null!==d.timeoutHandles[f]&&(clearTimeout(d.timeoutHandles[f]),d.timeoutHandles[f]=null),d.timeoutHandles[f]=setTimeout(k,d.typingDelay)})}},registerListener:function(a){d.listeners[d.listeners.length]=a}};return e});